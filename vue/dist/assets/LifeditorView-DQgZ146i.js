import{m as N,j as U,b as w,k as F,u as o,l as B,v as M,o as y,c as g,n as k,d as A,g as _,a as l,_ as E,q as L,F as D,r as H,t as O,p as T,f as j}from"./index-Cf83duXP.js";const C="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='128'%20height='128'%20viewBox='0%200%2032%2032'%3e%3cpath%20fill='currentColor'%20d='M16%2032C7.163%2032%200%2024.837%200%2016S7.163%200%2016%200s16%207.163%2016%2016a16%2016%200%200%201-16%2016m0-30C8.268%202%202%208.268%202%2016s6.268%2014%2014%2014s14-6.268%2014-14A14%2014%200%200%200%2016%202'/%3e%3cpath%20fill='currentColor'%20d='M23%2015h-6V9h-2v6H9v2h6v6h2v-6h6z'%20class='ouiIcon__fillSecondary'/%3e%3c/svg%3e",v={__name:"Input",props:N({type:String,func:Function,input_classes:{type:Object,default(i){return{field_editor_input:!0}}},minh:{type:Number,default:2}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const f=i,t=U(i,"modelValue"),{func:b,type:h,minh:p,input_classes:r}=f;h=="textarea"&&(r.auto_height=!0);let u=!1,c="";function x(e){return e.target.value==c}function a(e){x(e)||setTimeout(()=>{b(),c=t.value,e.target.style.color="black"},100)}function n(e){x(e)||(e.target.style.color="red",h=="textarea"&&Buda.dom.setAreaH(e.target,A.ui.rem,0,null,0,p),!u&&(u=!0,a(e),setTimeout(()=>{a(e),u=!1},5e3)))}return w(()=>{}),F(()=>{}),(e,d)=>o(h)=="textarea"?B((y(),g("textarea",{key:0,"onUpdate:modelValue":d[0]||(d[0]=s=>t.value=s),onInput:n,onBlue:a,class:k(o(r))},null,34)),[[M,t.value]]):B((y(),g("input",{key:1,"onUpdate:modelValue":d[1]||(d[1]=s=>t.value=s),onInput:n,onBlue:a,class:k(o(r))},null,34)),[[M,t.value]])}},z=l("div",{class:"field_editor_content_label"},"年",-1),J=l("div",{class:"field_editor_content_label"},"月",-1),P=l("div",{class:"field_editor_content_label"},"日",-1),$={__name:"Date",props:N({func:Function},{year:{},yearModifiers:{},month:{},monthModifiers:{},day:{},dayModifiers:{}}),emits:["update:year","update:month","update:day"],setup(i){const f=U(i,"year"),t=U(i,"month"),b=U(i,"day"),h=i,{func:p}=h;return w(()=>{}),(r,u)=>(y(),g("div",null,[_(v,{modelValue:f.value,"onUpdate:modelValue":u[0]||(u[0]=c=>f.value=c),func:o(p),input_classes:{field_editor_input_4chars:!0,center:!0}},null,8,["modelValue","func"]),z,_(v,{modelValue:t.value,"onUpdate:modelValue":u[1]||(u[1]=c=>t.value=c),func:o(p),input_classes:{field_editor_input_2chars:!0,center:!0}},null,8,["modelValue","func"]),J,_(v,{modelValue:b.value,"onUpdate:modelValue":u[2]||(u[2]=c=>b.value=c),func:o(p),input_classes:{field_editor_input_2chars:!0,center:!0}},null,8,["modelValue","func"]),P]))}},V=i=>(T("data-v-f3659515"),i=i(),j(),i),q={class:"page_comp_small_padding"},G={class:"editor"},K={class:"field_editor"},Q=V(()=>l("div",{class:"field_editor_label"},"标题",-1)),R={class:"field_editor_content"},W={class:"field_editor"},X=V(()=>l("div",{class:"field_editor_label"},"出生时间",-1)),Y={class:"field_editor_content"},Z={class:"field_editor"},ee=V(()=>l("div",{class:"field_editor_label"},"简称",-1)),te={class:"field_editor_content"},ne={class:"field_editor_multilines"},le=V(()=>l("div",{class:"field_editor_label"},"综述",-1)),ae={class:"field_editor_content"},oe=V(()=>l("div",null,"事件",-1)),se={class:"field_editor_verticle"},de=["onClick"],ie={class:"event_head"},re={class:"event_age"},ue={class:"field_editor_content"},_e={class:"field_editor_multilines"},ce=V(()=>l("div",{class:"field_editor_label"},"参考资料",-1)),me={class:"field_editor_content"},fe=V(()=>l("section",{class:"preview"},null,-1)),pe={__name:"Lifeditor",setup(i){function f(a,n,e){return{date:{year:a,month:n,day:e},content:""}}let t=localStorage.getItem("life");t?t=JSON.parse(t):t={name:"",title:"",birth:{year:1900,month:1,day:1},summary:"",events:[f(1900,1,1)],refs:""},t=L(t);function b(){return t.events[t.events.length-1]}function h(a){return a.date.year-t.birth.year}let p=!0;function r(){localStorage.setItem("life",JSON.stringify(t)),console.log("saved",new Date);let a=t.events[0].date,n=t.birth,{year:e,month:d,day:s}=a;p=e==1900&&d==1&&s==1||e==n.year&&d==n.month&&s==n.day}function u(){if(p){let a=t.events[0].date,n=t.birth;a.year=n.year,a.month=n.month,a.day=n.day}r()}function c(a,n){let e=/([0-9]{1,4})\s*年/,d=/([0-9]{1,2})\s*月/,s=/([0-9]{1,2})\s*日/,I=a.target.value,m,S=t.events[n].date;(m=e.exec(I))&&m.length>=2&&(S.year=parseInt(m[1])),(m=d.exec(I))&&m.length>=2&&(S.month=parseInt(m[1])),(m=s.exec(I))&&m.length>=2&&(S.day=parseInt(m[1]))}function x(a,n){let e=a;a||(e=b(),n=t.events.length);let d=e.date;t.events.splice(n,0,f(d.year,d.month,d.day)),r()}return w(()=>{let a=document.getElementsByClassName("auto_height");for(let n of a)Buda.dom.setAreaH(n,A.ui.rem,0,null,0,2)}),(a,n)=>(y(),g("div",q,[l("section",G,[l("div",K,[Q,l("div",R,[_(v,{modelValue:o(t).title,"onUpdate:modelValue":n[0]||(n[0]=e=>o(t).title=e),type:"textarea",input_classes:{field_editor_input_long:!0},func:r,maxh:3},null,8,["modelValue"])])]),l("div",W,[X,l("div",Y,[_($,{year:o(t).birth.year,"onUpdate:year":n[1]||(n[1]=e=>o(t).birth.year=e),month:o(t).birth.month,"onUpdate:month":n[2]||(n[2]=e=>o(t).birth.month=e),day:o(t).birth.day,"onUpdate:day":n[3]||(n[3]=e=>o(t).birth.day=e),func:u},null,8,["year","month","day"])])]),l("div",Z,[ee,l("div",te,[_(v,{modelValue:o(t).name,"onUpdate:modelValue":n[4]||(n[4]=e=>o(t).name=e),func:r},null,8,["modelValue"])])]),l("div",ne,[le,l("div",ae,[_(v,{modelValue:o(t).summary,"onUpdate:modelValue":n[5]||(n[5]=e=>o(t).summary=e),type:"textarea",input_classes:{field_editor_input_long:!0},func:r},null,8,["modelValue"])])]),oe,l("div",null,[(y(!0),g(D,null,H(o(t).events,(e,d)=>(y(),g("div",se,[l("div",null,[l("img",{src:C,onClick:s=>x(e,d),class:"add_img"},null,8,de)]),l("div",null,[l("div",ie,[_($,{year:e.date.year,"onUpdate:year":s=>e.date.year=s,month:e.date.month,"onUpdate:month":s=>e.date.month=s,day:e.date.day,"onUpdate:day":s=>e.date.day=s,func:r},null,8,["year","onUpdate:year","month","onUpdate:month","day","onUpdate:day"]),l("div",re,O(h(e))+"岁",1)]),l("div",ue,[_(v,{modelValue:e.content,"onUpdate:modelValue":s=>e.content=s,onInput:s=>c(s,d),type:"textarea",input_classes:{field_editor_input_long:!0},func:r},null,8,["modelValue","onUpdate:modelValue","onInput"])])])]))),256)),l("div",null,[l("img",{src:C,onClick:n[6]||(n[6]=e=>x()),class:"add_img"})])]),l("div",_e,[ce,l("div",me,[_(v,{modelValue:o(t).refs,"onUpdate:modelValue":n[7]||(n[7]=e=>o(t).refs=e),type:"textarea",input_classes:{field_editor_input_long:!0},func:r},null,8,["modelValue"])])])]),fe]))}},ve=E(pe,[["__scopeId","data-v-f3659515"]]),ye={__name:"LifeditorView",setup(i){return(f,t)=>(y(),g("main",null,[_(ve)]))}};export{ye as default};
